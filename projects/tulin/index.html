<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tulin | Journal</title>
    <meta name="description" content="A collection of tools and libraries to help expedite the machine learning workflow.">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.1f1142dd.css" as="style"><link rel="preload" href="/assets/js/app.69154cb4.js" as="script"><link rel="preload" href="/assets/js/3.5f73f230.js" as="script"><link rel="preload" href="/assets/js/21.7b907d07.js" as="script"><link rel="preload" href="/assets/js/7.420b440d.js" as="script"><link rel="prefetch" href="/assets/js/10.f5b564dd.js"><link rel="prefetch" href="/assets/js/11.6161e14f.js"><link rel="prefetch" href="/assets/js/12.c507c6be.js"><link rel="prefetch" href="/assets/js/13.da887918.js"><link rel="prefetch" href="/assets/js/14.327116d1.js"><link rel="prefetch" href="/assets/js/15.81df7efb.js"><link rel="prefetch" href="/assets/js/16.dc7eb4d8.js"><link rel="prefetch" href="/assets/js/17.f4f085d5.js"><link rel="prefetch" href="/assets/js/18.8657ea90.js"><link rel="prefetch" href="/assets/js/19.57477e05.js"><link rel="prefetch" href="/assets/js/2.41b86ceb.js"><link rel="prefetch" href="/assets/js/20.cf646c40.js"><link rel="prefetch" href="/assets/js/22.c57676bc.js"><link rel="prefetch" href="/assets/js/23.7bd29250.js"><link rel="prefetch" href="/assets/js/4.2a35f36b.js"><link rel="prefetch" href="/assets/js/5.c8140598.js"><link rel="prefetch" href="/assets/js/6.4d7a3744.js"><link rel="prefetch" href="/assets/js/8.dd6862ae.js"><link rel="prefetch" href="/assets/js/9.ee975aae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1f1142dd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Journal</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/resume/" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/projects/interview-bot/" class="nav-link">
  Interview My Bot
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/resume/" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/projects/interview-bot/" class="nav-link">
  Interview My Bot
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tulin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/projects/tulin/#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#motivation" class="sidebar-link">Motivation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#design" class="sidebar-link">Design</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#fastai-callback" class="sidebar-link">FastAI Callback</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/projects/tulin/#autosave" class="sidebar-link">Autosave</a></li><li class="sidebar-sub-header"><a href="/projects/tulin/#tensorboard" class="sidebar-link">Tensorboard</a></li></ul></li><li><a href="/projects/tulin/#export" class="sidebar-link">Export</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#usage" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/projects/tulin/#future-plans" class="sidebar-link">Future Plans</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="hero" data-v-7772bab1><h1 data-v-7772bab1>Tulin</h1> <div class="image" style="background-image:url(/images/tulin-cover.jpg);" data-v-7772bab1></div> <p data-v-7772bab1>Published: 2019-10-01</p> <p data-v-7772bab1>  Updated: 2020-02-10</p></div> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>Tulin is a pip installable collection of small tools and libraries to help expedite the machine learning workflow. At present, centered around fastai, features include a callback that supports autosave and Tensorboard logging, as well as Jupyter based application development support in the form of an exporter that converts Jupyter notebooks into Python code.</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Machine learning and it's tooling support is still in it's early stages. Over the course of development, scripts that were written as one off helper functions may become used over and over. There was a need to consolidate these tools and create a platform that allowed for the easy collection, implementation and usage of these tools. Tulin is a pip installable collection of such scripts.</p> <h2 id="design"><a href="#design" class="header-anchor">#</a> Design</h2> <p>Most design aspects of the functionality in the scripts are centered around <code>fast.ai</code> and its development workflows. fast.ai has an excellent callback system which allows for almost any functionality to be effectively (and in an officially supported way) monkey patched into its workflow. In addition, Tulin includes an <code>Export</code> script that copies another fastai workflow - converting Jupyter notebooks into Python libraries and applications. This allows Jupyter notebook users to build and experiment with code in a notebook and then convert the relevant cells of those notebooks into Python scripts.</p> <h2 id="fastai-callback"><a href="#fastai-callback" class="header-anchor">#</a> FastAI Callback</h2> <h3 id="autosave"><a href="#autosave" class="header-anchor">#</a> Autosave</h3> <p>The autosave functionality of the fastai callback allows the user to specify a &quot;primary metric&quot; - a metric used with the fastai learner. The callback then keeps track of that value of the metric each epoch. If the new value is better than the last best value, the value is updated and the model is saved along with information about the metric and the epoch it happened. This not only allows for the best network to be saved but also helps guide in determining the number of epochs to use.</p> <h3 id="tensorboard"><a href="#tensorboard" class="header-anchor">#</a> Tensorboard</h3> <p>In addition to tracking the primary metric, the callback logs all metrics to Tensorboard using the <a href="https://pytorch.org/docs/stable/tensorboard.html" target="_blank" rel="noopener noreferrer">official support built into PyTorch 1.2+<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, which eliminates the need for TensorboardX. The current official fastai implementation of Tensorboard relies on TensorboardX, so this implementation was created to use the latest and direct method of PyTorch/Tensorboard logging.</p> <h2 id="export"><a href="#export" class="header-anchor">#</a> Export</h2> <p>Inspired by Sylvain Gugger and Jeremy Howard's <a href="https://github.com/fastai/fastai_dev/blob/master/dev/91_notebook_export.ipynb" target="_blank" rel="noopener noreferrer">implementation in fastai-dev<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the Export functionality allows development to be done in Jupyter notebooks for complex libraries and applications in a experimental manner.</p> <p>The export script looks for cells that need to be exported (which contains the comment <code>#export</code> at the top of the cell) and generates a Python file from the notebook. Additionally, to allow for the notebook to import files generated from other notebooks, packages are imported from the output folder i.e. <code>import src.&lt;package&gt;</code>. The exporter script changes these values to <code>import .&lt;package&gt;</code> so scripts in the output folder also import from the output folder. The Export script takes fastai's implementation one step further by being implemented as a pip installable library, so that any notebook folder can run the export script and generate Python code from it.</p> <p>Note, because the export script relies on relative paths, launching entrypoint scripts in the traditional manner (i.e. file has <code>if __name__ == __main__</code> and <code>python app.py</code>) does not work. This is because relative imports use the name to determine relativity but when launched this way with Python,<code>__name__</code> is set to <code>__main__</code> to denote it as the entry script. Instead, to launch your entry script, use the module method of invocation: <code>python -m src.app</code> - this must be done from outside the src folder (which is now being treated as a module).</p> <div class="custom-block danger"><p class="custom-block-title">Update</p> <p>Since the building of this tool, fast.ai has released nbdev which handles this Jupyter notebook development my more elegantly. At present, the Export functionality is deprecated with future review for removal and integration of <a href="https://www.fast.ai/2019/12/02/nbdev/" target="_blank" rel="noopener noreferrer">fast.ai's nbdev<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>As of this update, Tulin is intended to be installed as an editable package. The install bash script in the src folder handles this for us:</p> <div class="language- extra-class"><pre class="language-text"><code>pip install -e . --user
</code></pre></div><h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <p>The fastai callback can then be appended to the fastai learner:</p> <div class="language- extra-class"><pre class="language-text"><code>from tulin.fastai import Callback
learner.callbacks.append(Callback(learner, &quot;&lt;primary metric&gt;&quot;, &quot;&lt;experiment name&gt;&quot;, &quot;&lt;experiment comments&gt;&quot;))
</code></pre></div><p>The exporter should be executed using Python and the <code>-m</code> flag in the directory you wish to export:</p> <div class="language- extra-class"><pre class="language-text"><code>python -m tulin.scripts.export
</code></pre></div><h2 id="future-plans"><a href="#future-plans" class="header-anchor">#</a> Future Plans</h2> <ul><li>integration of experiments library to help with testing different networks and hyperparemeters</li> <li>integration of automatic Bayesian Optimization</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.69154cb4.js" defer></script><script src="/assets/js/3.5f73f230.js" defer></script><script src="/assets/js/21.7b907d07.js" defer></script><script src="/assets/js/7.420b440d.js" defer></script>
  </body>
</html>
